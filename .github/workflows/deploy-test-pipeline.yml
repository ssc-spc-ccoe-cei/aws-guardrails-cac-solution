name: Deploy to Test

on:
  workflow_dispatch:
  push:
    branches:
      - main

env:
  AWS_REGION: ca-central-1
  ENVIRONMENT: test

jobs:
  deployToTest:
    permissions:
      id-token: write
      contents: read
  
    uses: ssc-spc-ccoe-cei/aws-guardrails-cac-solution/.github/workflows/deploy.yml@singhgss-patch-1
    with:
      environment: ${{ env.ENVIRONMENT }}
      aws-region: ${{ env.AWS_REGION }}
      deploy-version: ${{ vars[ format('{0}_DEPLOY_VERSION', env.ENVIRONMENT) ] }} 
    secrets:
      aws-role-arn: ${{ secrets[ format('{0}_AWS_ROLE_ARN', env.ENVIRONMENT) ] }}
      config-file-content: ${{ secrets[ format('{0}_CONFIG_FILE_CONTENT', env.ENVIRONMENT) ] }}
      

