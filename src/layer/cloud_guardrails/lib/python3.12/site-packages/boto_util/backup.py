import logging
import time


logger = logging.getLogger()
logger.setLevel(logging.INFO)


def list_all_backup_vaults(backup_client, page_size: int = 25, interval_between_calls: float = 0.05):
    """Get the list of backup vaults"""
    resources: list[dict] = []
    paginator = backup_client.get_paginator("list_backup_vaults")
    page_iterator = paginator.paginate(PaginationConfig={"PageSize": page_size})
    for page in page_iterator:
        resources.extend(page.get("BackupVaultList", []))
        time.sleep(interval_between_calls)
    return resources


def list_all_recovery_points_by_backup_vault(
    backup_client, backup_vault_name: str, page_size: int = 25, interval_between_calls: float = 0.05
):
    """Get the list of recovery points for a given backup vault"""
    resources: list[dict] = []
    paginator = backup_client.get_paginator("list_recovery_points_by_backup_vault")
    page_iterator = paginator.paginate(BackupVaultName=backup_vault_name, PaginationConfig={"PageSize": page_size})
    for page in page_iterator:
        resources.extend(page.get("RecoveryPoints", []))
        time.sleep(interval_between_calls)
    return resources
