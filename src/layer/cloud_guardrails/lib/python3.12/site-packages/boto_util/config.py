import json


def build_evaluation(
    resource_id: str,
    compliance_type: str,
    event: dict,
    resource_type: str = "AWS::::Account",
    annotation: str | None = None,
) -> dict:
    """
    Form an evaluation as a dictionary. Usually suited to report on scheduled rules.

    Keyword arguments:

        resource_id -- the unique id of the resource to report

        compliance_type -- either COMPLIANT, NON_COMPLIANT or NOT_APPLICABLE

        event -- the event variable given in the lambda handler

        resource_type -- the CloudFormation resource type to report on the rule (default AWS::::Account)

        annotation -- an annotation to be added to the evaluation (default None)
    """
    evaluation = {
        "ComplianceResourceId": resource_id,
        "ComplianceResourceType": resource_type,
        "ComplianceType": compliance_type,
        "OrderingTimestamp": str(json.loads(event["invokingEvent"])["notificationCreationTime"]),
    }

    if annotation:
        evaluation["Annotation"] = annotation

    return evaluation
