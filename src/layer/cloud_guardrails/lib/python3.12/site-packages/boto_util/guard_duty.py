import logging

import botocore.exceptions

logger = logging.getLogger()
logger.setLevel(logging.INFO)


def guard_duty_is_enabled(guard_duty_client) -> bool:
    try:
        response = guard_duty_client.list_detectors()
        detectorIds = response.get("DetectorIds", [])
        return len(detectorIds) > 0
    except botocore.exceptions.ClientError as ex:
        if "BadRequest" in ex.response["Error"]["Code"]:
            ex.response["Error"]["Message"] = "Failed to fetch detector ids for GuardDuty. Bad Request."
        else:
            ex.response["Error"]["Message"] = "InternalError"
            ex.response["Error"]["Code"] = "InternalError"
        raise ex
