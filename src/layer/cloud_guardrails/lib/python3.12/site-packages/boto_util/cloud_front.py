import logging
import time


logger = logging.getLogger()
logger.setLevel(logging.INFO)


def list_all_cloud_front_distributions(cloud_front_client, page_size: int = 25, interval_between_calls: float = 0.05):
    """
    Get a list of all the Cloud Front Distributions
    https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/cloudfront/paginator/ListDistributions.html
    """
    resources: list[dict] = []
    paginator = cloud_front_client.get_paginator("list_distributions")
    page_iterator = paginator.paginate(PaginationConfig={"PageSize": page_size})
    for page in page_iterator:
        resources.extend(page.get("DistributionList", {}).get("Items", []))
        time.sleep(interval_between_calls)
    return resources
