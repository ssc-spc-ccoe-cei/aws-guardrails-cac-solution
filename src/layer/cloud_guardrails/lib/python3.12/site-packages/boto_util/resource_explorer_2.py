import logging
import time

import botocore.exceptions

logger = logging.getLogger()
logger.setLevel(logging.INFO)


def resource_explorer_get_indexes(
    resource_explorer_client, index_type=None, page_size=25, interval_between_calls: float = 0.05
):

    resources: list[dict] = []
    paginator = resource_explorer_client.get_paginator("list_indexes")

    if not index_type:
        page_iterator = paginator.paginate(PaginationConfig={"MaxItems": page_size})
    else:
        page_iterator = paginator.paginate(Type=index_type, PaginationConfig={"MaxItems": page_size})

    for page in page_iterator:
        resources.extend(page.get("Indexes", []))
        time.sleep(interval_between_calls)

    return resources
